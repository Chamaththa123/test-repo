<!DOCTYPE html>
<html>
<head>
  <title>Security Test Page - Extended Vulnerabilities</title>
</head>
<body>
  <h1>Vulnerability Testing</h1>

  <!-- XSS Vulnerability -->
  <div id="xssTest"></div>
  <script>
    // ðŸ”´ XSS via innerHTML with unsanitized input
    document.getElementById("xssTest").innerHTML = location.search;

    // ðŸ”´ SQL Injection
    const mysql = require("mysql");
    const connection = mysql.createConnection({
      host: "localhost",
      user: "root",   // ðŸ”´ Hardcoded DB credentials
      password: "root123",
      database: "test"
    });
    let userId = "' OR 1=1 --"; // bad input
    connection.query("SELECT * FROM users WHERE id = " + userId);

    // ðŸ”´ Command Injection
    const { exec } = require("child_process");
    const userInput = "; rm -rf /"; // malicious input
    exec("ls -la " + userInput);

    // ðŸ”´ Hardcoded secret
    const apiKey = "12345-ABCDE-SECRET";

    // ðŸ”´ Insecure random
    const randomNumber = Math.random();

    // ðŸ”´ Prototype pollution
    Object.prototype.polluted = "yes";

    // ðŸ”´ Insecure deserialization
    const data = '{"__proto__": {"hacked": true}}';
    const parsed = JSON.parse(data);

    // ðŸ”´ Weak crypto
    const crypto = require("crypto");
    const hash = crypto.createHash("md5").update("password").digest("hex");

    // ðŸ”´ Information disclosure
    console.log("User password: secret123");

    // ðŸ”´ Insecure communication (no HTTPS)
    fetch("http://example.com/api/data");

    // ðŸ”´ Exposed stack trace
    try {
      throw new Error("Something went wrong");
    } catch (err) {
      document.body.innerHTML += "<pre>" + err.stack + "</pre>";
    }

    // ðŸ”´ Insecure regex (ReDoS)
    const regex = /(a+)+$/;
    regex.test("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa!");

    // ðŸ”´ CSRF (no protection on sensitive request)
    fetch("/deleteUser?id=1", { method: "POST" });

    // ðŸ”´ Unrestricted file upload simulation
    const fs = require("fs");
    function uploadFile(filePath) {
      // No validation of file type or size
      fs.copyFileSync(filePath, "/uploads/" + filePath);
    }
    uploadFile("malware.exe");

    // ðŸ”´ Insecure JWT usage
    const jwt = require("jsonwebtoken");
    const token = jwt.sign({ admin: true }, "weak-secret"); // hardcoded weak key

    // ðŸ”´ Missing Content Security Policy
    // (Should normally set in <meta http-equiv="Content-Security-Policy">, but omitted)

    // ðŸ”´ Broken authentication simulation
    function login(username, password) {
      if (username && password) {
        return true; // accepts any credentials
      }
      return false;
    }
    console.log("Login bypass:", login("attacker", "wrongpass"));

  </script>
</body>
</html>
